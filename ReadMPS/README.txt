CAVEAT: This code is 20+ years old and in need of updating.